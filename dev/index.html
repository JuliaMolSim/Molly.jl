<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · Molly.jl</title><meta name="title" content="Home · Molly.jl"/><meta property="og:title" content="Home · Molly.jl"/><meta property="twitter:title" content="Home · Molly.jl"/><meta name="description" content="Documentation for Molly.jl."/><meta property="og:description" content="Documentation for Molly.jl."/><meta property="twitter:description" content="Documentation for Molly.jl."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href><img src="assets/logo.svg" alt="Molly.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href>Molly.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Installation"><span>Installation</span></a></li><li><a class="tocitem" href="#Usage"><span>Usage</span></a></li><li><a class="tocitem" href="#Contributing"><span>Contributing</span></a></li><li><a class="tocitem" href="#Citation"><span>Citation</span></a></li><li><a class="tocitem" href="#Interested?"><span>Interested?</span></a></li></ul></li><li><a class="tocitem" href="documentation/">Documentation</a></li><li><a class="tocitem" href="differentiable/">Differentiable simulation</a></li><li><a class="tocitem" href="examples/">Examples</a></li><li><a class="tocitem" href="exercises/">Exercises</a></li><li><a class="tocitem" href="publications/">Publications</a></li><li><a class="tocitem" href="related/">Related software</a></li><li><a class="tocitem" href="development/">Development</a></li><li><a class="tocitem" href="api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaMolSim/Molly.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaMolSim/Molly.jl/blob/master/README.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><p>&lt;img src=&quot;https://github.com/JuliaMolSim/Molly.jl/blob/master/docs/src/images/logo_molly.png&quot; alt=&quot;Molly logo&quot; width=&quot;400&quot;&gt;</p><p><a href="https://github.com/JuliaMolSim/Molly.jl/actions"><img src="https://github.com/JuliaMolSim/Molly.jl/workflows/CI/badge.svg" alt="Build status"/></a> <a href="https://codecov.io/gh/JuliaMolSim/Molly.jl"><img src="https://codecov.io/gh/JuliaMolSim/Molly.jl/branch/master/graph/badge.svg?token=RD9XF0W90L" alt="Coverage status"/></a> <a href="https://github.com/JuliaMolSim/Molly.jl/releases/latest"><img src="https://img.shields.io/github/release/JuliaMolSim/Molly.jl.svg" alt="Latest release"/></a> <a href="https://github.com/JuliaMolSim/Molly.jl/blob/master/LICENSE.md"><img src="https://img.shields.io/badge/license-MIT-green.svg" alt="License"/></a> <a href="https://JuliaMolSim.github.io/Molly.jl/stable"><img src="https://img.shields.io/badge/docs-stable-blue.svg" alt="Documentation stable"/></a> <a href="https://JuliaMolSim.github.io/Molly.jl/dev"><img src="https://img.shields.io/badge/docs-dev-blue.svg" alt="Documentation dev"/></a></p><p>Much of science can be explained by the movement and interaction of molecules. Molecular dynamics (MD) is a computational technique used to explore these phenomena, from noble gases to biological macromolecules. Molly.jl is a pure Julia package for MD, and for the simulation of physical systems more broadly.</p><p>The package is described in <a href="https://www.youtube.com/watch?v=XTE5HSo-jx8">a talk</a> at JuliaCon 2024, <a href="https://www.youtube.com/watch?v=6G97jDVPlYc">an earlier talk</a> at Enzyme Conference 2023 and <a href="https://www.youtube.com/watch?v=rVRWIxLyjgE">a tutorial</a> at the MolSSI JuliaMolSim Workshop 2024. <a href="https://docs.google.com/presentation/d/1SjzRi7jFbgFwP9kupwdtkxmr2x0OWjzzXwnoenCcCQg/edit?usp=sharing">Slides</a> are also available for a tutorial in September 2023.</p><p>Implemented features include:</p><ul><li>Non-bonded interactions - Lennard-Jones Van der Waals/repulsion force, electrostatic Coulomb potential and reaction field, gravitational potential, soft sphere potential, Mie potential, Buckingham potential, soft core variants.</li><li>Bonded interactions - harmonic and Morse bonds, bond angles, torsion angles, harmonic position restraints, FENE bonds.</li><li>Interface to allow definition of new interactions, simulators, thermostats, neighbor finders, loggers etc.</li><li>Read in OpenMM force field files and coordinate files supported by <a href="https://github.com/chemfiles/Chemfiles.jl">Chemfiles.jl</a>. There is also experimental support for Gromacs files.</li><li>Write out trajectory files in formats supported by Chemfiles.jl, including DCD and XTC.</li><li>Verlet, velocity Verlet, Störmer-Verlet, flexible Langevin and Nosé-Hoover integrators.</li><li>Andersen, Berendsen and velocity rescaling thermostats.</li><li>Monte Carlo barostat and variants.</li><li>Steepest descent energy minimization.</li><li>Replica exchange molecular dynamics.</li><li>Monte Carlo simulation.</li><li>Periodic, triclinic and infinite boundary conditions.</li><li>Constraints with SHAKE and RATTLE</li><li>Flexible loggers to track arbitrary properties throughout simulations.</li><li>Cutoff algorithms for non-bonded interactions.</li><li>Various neighbor list implementations to speed up the calculation of non-bonded forces, including the use of <a href="https://github.com/m3g/CellListMap.jl">CellListMap.jl</a>.</li><li>Implicit solvent GBSA methods.</li><li><a href="https://github.com/PainterQubits/Unitful.jl">Unitful.jl</a> compatibility so numbers have physical meaning.</li><li>Set up crystal systems using <a href="https://github.com/ejmeitz/SimpleCrystals.jl">SimpleCrystals.jl</a>.</li><li>Automatic multithreading.</li><li>GPU acceleration on all backends supported by <a href="https://github.com/JuliaGPU/KernelAbstractions.jl">KernelAbstractions.jl</a>, with better performance on CUDA-enabled devices.</li><li>Run with Float64, Float32 or other float types.</li><li>Some analysis functions, e.g. RDF.</li><li>Visualise simulations as animations with <a href="https://makie.juliaplots.org/stable">Makie.jl</a>.</li><li>Compatibility with <a href="https://github.com/JuliaMolSim/AtomsBase.jl">AtomsBase.jl</a> and <a href="https://github.com/JuliaMolSim/AtomsCalculators.jl">AtomsCalculators.jl</a>.</li><li>Interface to use Python <a href="https://wiki.fysik.dtu.dk/ase">ASE</a> calculators.</li><li>Control of random numbers during simulation, allowing reproducible stochastic simulations.</li><li>Differentiable molecular simulation. This is a unique feature of the package and the focus of its current development.</li></ul><p>Features not yet implemented include:</p><ul><li>High GPU performance.</li><li>Ewald or particle mesh Ewald summation.</li><li>Full support for constrained bonds and angles.</li><li>Protein preparation - solvent box, add hydrogens etc.</li><li>Simulators such as metadynamics.</li><li>Quantum mechanical modelling.</li><li>Domain decomposition algorithms.</li><li>Alchemical free energy calculations.</li><li>High test coverage.</li><li>API stability.</li></ul><h2 id="Installation"><a class="docs-heading-anchor" href="#Installation">Installation</a><a id="Installation-1"></a><a class="docs-heading-anchor-permalink" href="#Installation" title="Permalink"></a></h2><p><a href="https://julialang.org/downloads">Julia</a> is required, with Julia v1.10 or later required to get the latest version of Molly. It is recommended to run on the current stable Julia release for the best performance. Install Molly from the Julia REPL. Enter the package mode by pressing <code>]</code> and run <code>add Molly</code>.</p><h2 id="Usage"><a class="docs-heading-anchor" href="#Usage">Usage</a><a id="Usage-1"></a><a class="docs-heading-anchor-permalink" href="#Usage" title="Permalink"></a></h2><p>Some examples are given here, see <a href="https://juliamolsim.github.io/Molly.jl/stable/documentation">the documentation</a> for more on how to use the package.</p><p>Simulation of a Lennard-Jones fluid:</p><pre><code class="language-julia hljs">using Molly

n_atoms = 100
boundary = CubicBoundary(2.0u&quot;nm&quot;)
temp = 298.0u&quot;K&quot;
atom_mass = 10.0u&quot;g/mol&quot;

atoms = [Atom(mass=atom_mass, σ=0.3u&quot;nm&quot;, ϵ=0.2u&quot;kJ * mol^-1&quot;) for i in 1:n_atoms]
coords = place_atoms(n_atoms, boundary; min_dist=0.3u&quot;nm&quot;)
velocities = [random_velocity(atom_mass, temp) for i in 1:n_atoms]
pairwise_inters = (LennardJones(),)
simulator = VelocityVerlet(
    dt=0.002u&quot;ps&quot;,
    coupling=AndersenThermostat(temp, 1.0u&quot;ps&quot;),
)

sys = System(
    atoms=atoms,
    coords=coords,
    boundary=boundary,
    velocities=velocities,
    pairwise_inters=pairwise_inters,
    loggers=(temp=TemperatureLogger(100),),
)

simulate!(sys, simulator, 10_000)</code></pre><p>Simulation of a protein:</p><pre><code class="language-julia hljs">using Molly

sys = System(
    joinpath(dirname(pathof(Molly)), &quot;..&quot;, &quot;data&quot;, &quot;5XER&quot;, &quot;gmx_coords.gro&quot;),
    joinpath(dirname(pathof(Molly)), &quot;..&quot;, &quot;data&quot;, &quot;5XER&quot;, &quot;gmx_top_ff.top&quot;);
    nonbonded_method=&quot;pme&quot;,
    loggers=(
        temp=TemperatureLogger(10),
        writer=TrajectoryWriter(10, &quot;traj_5XER_1ps.pdb&quot;),
    ),
)

temp = 298.0u&quot;K&quot;
random_velocities!(sys, temp)
simulator = VelocityVerlet(
    dt=0.0002u&quot;ps&quot;,
    coupling=AndersenThermostat(temp, 1.0u&quot;ps&quot;),
)

simulate!(sys, simulator, 5_000)</code></pre><p>The above 1 ps simulation looks something like this when you view it in <a href="https://www.ks.uiuc.edu/Research/vmd">VMD</a>: <img src="https://github.com/JuliaMolSim/Molly.jl/raw/master/data/5XER/sim_1ps.gif" alt="MD simulation"/></p><h2 id="Contributing"><a class="docs-heading-anchor" href="#Contributing">Contributing</a><a id="Contributing-1"></a><a class="docs-heading-anchor-permalink" href="#Contributing" title="Permalink"></a></h2><p>Contributions are very welcome including reporting bugs, fixing bugs, adding new features, improving performance, adding tests and improving documentation. Feel free to open an issue or use the channels below to discuss your contribution. New features will generally require tests to be added as well. See the <a href="https://github.com/JuliaMolSim/Molly.jl/issues/2">roadmap issue</a> for some discussion of recent progress and future plans.</p><p>Join the #juliamolsim channel on the <a href="https://join.slack.com/t/julialang/shared_invite/zt-26arhonkh-WYNI2rI2X85jcbkn6pRAjA">Julia Slack</a>, the #molly channel on the <a href="https://juliamolsim.zulipchat.com/join/j5sqhiajbma5hw55hy6wtzv7">JuliaMolSim Zulip</a> or post on the <a href="https://discourse.julialang.org">Julia Discourse</a> to discuss the usage and development of Molly.jl.</p><p>Molly.jl follows the Contributor Covenant <a href="https://github.com/JuliaMolSim/Molly.jl/blob/master/CODE_OF_CONDUCT.md">code of conduct</a>.</p><h2 id="Citation"><a class="docs-heading-anchor" href="#Citation">Citation</a><a id="Citation-1"></a><a class="docs-heading-anchor-permalink" href="#Citation" title="Permalink"></a></h2><p>If you use Molly, please cite the following paper (<a href="https://github.com/JuliaMolSim/Molly.jl/blob/master/CITATION.bib">bib entry here</a>):</p><ul><li>Greener JG. Differentiable simulation to develop molecular dynamics force fields for disordered proteins, <a href="https://doi.org/10.1039/D3SC05230C">Chemical Science</a> 15, 4897-4909 (2024)</li></ul><p>A paper involving more contributors with further details on the software will be written at some point.</p><h2 id="Interested?"><a class="docs-heading-anchor" href="#Interested?">Interested?</a><a id="Interested?-1"></a><a class="docs-heading-anchor-permalink" href="#Interested?" title="Permalink"></a></h2><p>There is the possibility of a postdoc position involving the development and use of Molly. Contact Joe Greener with informal enquiries.</p></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="documentation/">Documentation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Monday 1 September 2025 04:22">Monday 1 September 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
