<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · Molly.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">Molly.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../docs/">Documentation</a></li><li><a class="tocitem" href="../differentiable/">Differentiable simulation</a></li><li><a class="tocitem" href="../examples/">Examples</a></li><li class="is-active"><a class="tocitem" href>API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaMolSim/Molly.jl/blob/master/docs/src/api.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Molly-API"><a class="docs-heading-anchor" href="#Molly-API">Molly API</a><a id="Molly-API-1"></a><a class="docs-heading-anchor-permalink" href="#Molly-API" title="Permalink"></a></h1><p>The API reference can be found here.</p><p>Molly also re-exports <a href="https://github.com/JuliaArrays/StaticArrays.jl">StaticArrays.jl</a>, making the likes of <code>SVector</code> available when you call <code>using Molly</code>.</p><p>The <a href="#Molly.visualize"><code>visualize</code></a> function is only available once you have called <code>using Makie</code>. <a href="https://github.com/JuliaPackaging/Requires.jl">Requires.jl</a> is used to lazily load this code when <a href="https://github.com/JuliaPlots/Makie.jl">Makie.jl</a> is available, which reduces the dependencies of the package.</p><ul><li><a href="#Molly.AbstractCutoff"><code>Molly.AbstractCutoff</code></a></li><li><a href="#Molly.AndersenThermostat"><code>Molly.AndersenThermostat</code></a></li><li><a href="#Molly.Angletype"><code>Molly.Angletype</code></a></li><li><a href="#Molly.Atom"><code>Molly.Atom</code></a></li><li><a href="#Molly.AtomMin"><code>Molly.AtomMin</code></a></li><li><a href="#Molly.Atomtype"><code>Molly.Atomtype</code></a></li><li><a href="#Molly.Bondtype"><code>Molly.Bondtype</code></a></li><li><a href="#Molly.CoordinateLogger"><code>Molly.CoordinateLogger</code></a></li><li><a href="#Molly.Coulomb"><code>Molly.Coulomb</code></a></li><li><a href="#Molly.DistanceNeighbourFinder"><code>Molly.DistanceNeighbourFinder</code></a></li><li><a href="#Molly.EnergyLogger"><code>Molly.EnergyLogger</code></a></li><li><a href="#Molly.GeneralInteraction"><code>Molly.GeneralInteraction</code></a></li><li><a href="#Molly.Gravity"><code>Molly.Gravity</code></a></li><li><a href="#Molly.HarmonicAngle"><code>Molly.HarmonicAngle</code></a></li><li><a href="#Molly.HarmonicBond"><code>Molly.HarmonicBond</code></a></li><li><a href="#Molly.Interaction"><code>Molly.Interaction</code></a></li><li><a href="#Molly.LennardJones"><code>Molly.LennardJones</code></a></li><li><a href="#Molly.Logger"><code>Molly.Logger</code></a></li><li><a href="#Molly.Mie"><code>Molly.Mie</code></a></li><li><a href="#Molly.NeighbourFinder"><code>Molly.NeighbourFinder</code></a></li><li><a href="#Molly.NoNeighbourFinder"><code>Molly.NoNeighbourFinder</code></a></li><li><a href="#Molly.NoThermostat"><code>Molly.NoThermostat</code></a></li><li><a href="#Molly.Simulation"><code>Molly.Simulation</code></a></li><li><a href="#Molly.Simulator"><code>Molly.Simulator</code></a></li><li><a href="#Molly.SoftSphere"><code>Molly.SoftSphere</code></a></li><li><a href="#Molly.SpecificInteraction"><code>Molly.SpecificInteraction</code></a></li><li><a href="#Molly.StructureWriter"><code>Molly.StructureWriter</code></a></li><li><a href="#Molly.TemperatureLogger"><code>Molly.TemperatureLogger</code></a></li><li><a href="#Molly.Thermostat"><code>Molly.Thermostat</code></a></li><li><a href="#Molly.Torsion"><code>Molly.Torsion</code></a></li><li><a href="#Molly.Torsiontype"><code>Molly.Torsiontype</code></a></li><li><a href="#Molly.VelocityFreeVerlet"><code>Molly.VelocityFreeVerlet</code></a></li><li><a href="#Molly.VelocityVerlet"><code>Molly.VelocityVerlet</code></a></li><li><a href="#Molly.accelerations-Tuple{Simulation}"><code>Molly.accelerations</code></a></li><li><a href="#Molly.adjust_bounds-Tuple{Real,Real}"><code>Molly.adjust_bounds</code></a></li><li><a href="#Molly.apply_thermostat!-Tuple{Any,Simulation,NoThermostat}"><code>Molly.apply_thermostat!</code></a></li><li><a href="#Molly.displacements-Tuple{Any,Real}"><code>Molly.displacements</code></a></li><li><a href="#Molly.distances-Tuple{Any,Real}"><code>Molly.distances</code></a></li><li><a href="#Molly.energy-Tuple{Any}"><code>Molly.energy</code></a></li><li><a href="#Molly.find_neighbours!-Tuple{Simulation,NoNeighbourFinder,Integer}"><code>Molly.find_neighbours!</code></a></li><li><a href="#Molly.force"><code>Molly.force</code></a></li><li><a href="#Molly.log_property!-Tuple{TemperatureLogger,Simulation,Integer}"><code>Molly.log_property!</code></a></li><li><a href="#Molly.maxwellboltzmann-Tuple{Type,Real,Real}"><code>Molly.maxwellboltzmann</code></a></li><li><a href="#Molly.placeatoms-Tuple{Type,Integer,Real,Real}"><code>Molly.placeatoms</code></a></li><li><a href="#Molly.rdf-Tuple{Any,Real}"><code>Molly.rdf</code></a></li><li><a href="#Molly.readinputs-Tuple{Type,AbstractString,AbstractString}"><code>Molly.readinputs</code></a></li><li><a href="#Molly.simulate!-Tuple{Simulation{false,T,A,C,GI,SI} where SI where GI where C where A where T,VelocityVerlet,Integer}"><code>Molly.simulate!</code></a></li><li><a href="#Molly.temperature-Tuple{Simulation{false,T,A,C,GI,SI} where SI where GI where C where A where T}"><code>Molly.temperature</code></a></li><li><a href="#Molly.vector-Tuple{Any,Any,Real}"><code>Molly.vector</code></a></li><li><a href="#Molly.vector1D-Tuple{Real,Real,Real}"><code>Molly.vector1D</code></a></li><li><a href="#Molly.velocity-Tuple{Type,Real,Real}"><code>Molly.velocity</code></a></li><li><a href="#Molly.visualize"><code>Molly.visualize</code></a></li></ul><article class="docstring"><header><a class="docstring-binding" id="Molly.AbstractCutoff" href="#Molly.AbstractCutoff"><code>Molly.AbstractCutoff</code></a> — <span class="docstring-category">Type</span></header><section><div><p>A general type of cutoff encoding the approximation used for a potential. Interactions can be parametrized by the cutoff behavior.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/types.jl#L33-L36">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.AndersenThermostat" href="#Molly.AndersenThermostat"><code>Molly.AndersenThermostat</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">AndersenThermostat(coupling_const)</code></pre><p>Rescale random velocities according to the Andersen thermostat.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/thermostats.jl#L28-L32">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.Angletype" href="#Molly.Angletype"><code>Molly.Angletype</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Angletype(th0, cth)</code></pre><p>Gromacs angle type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/setup.jl#L34-L38">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.Atom" href="#Molly.Atom"><code>Molly.Atom</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Atom(; &lt;keyword arguments&gt;)</code></pre><p>An atom and its associated information. Properties unused in the simulation or in analysis can be left with their default values. This type cannot be used on the GPU as it is not <code>isbits</code> - use <code>AtomMin</code> instead.</p><p><strong>Arguments</strong></p><ul><li><code>attype::AbstractString=&quot;&quot;</code>: the type of the atom.</li><li><code>name::AbstractString=&quot;&quot;</code>: the name of the atom.</li><li><code>resnum::Integer=0</code>: the residue number if the atom is part of a polymer.</li><li><code>resname::AbstractString=&quot;&quot;</code>: the residue name if the atom is part of a   polymer.</li><li><code>charge::T=0.0</code>: the charge of the atom, used for electrostatic interactions.</li><li><code>mass::T=0.0</code>: the mass of the atom.</li><li><code>σ::T=0.0</code>: the Lennard-Jones finite distance at which the inter-particle   potential is zero.</li><li><code>ϵ::T=0.0</code>: the Lennard-Jones depth of the potential well.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/types.jl#L63-L82">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.AtomMin" href="#Molly.AtomMin"><code>Molly.AtomMin</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">AtomMin(; &lt;keyword arguments&gt;)</code></pre><p>An atom and minimal information required for simulation. Properties unused in the simulation or in analysis can be left with their default values. This type is <code>isbits</code> and can be used on the GPU - use <code>Atom</code> in other contexts to store more information.</p><p><strong>Arguments</strong></p><ul><li><code>charge::T=0.0</code>: the charge of the atom, used for electrostatic interactions.</li><li><code>mass::T=0.0</code>: the mass of the atom.</li><li><code>σ::T=0.0</code>: the Lennard-Jones finite distance at which the inter-particle   potential is zero.</li><li><code>ϵ::T=0.0</code>: the Lennard-Jones depth of the potential well.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/types.jl#L114-L129">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.Atomtype" href="#Molly.Atomtype"><code>Molly.Atomtype</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Atomtype(mass, charge, σ, ϵ)</code></pre><p>Gromacs atom type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/setup.jl#L12-L16">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.Bondtype" href="#Molly.Bondtype"><code>Molly.Bondtype</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Bondtype(b0, kb)</code></pre><p>Gromacs bond type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/setup.jl#L24-L28">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.CoordinateLogger" href="#Molly.CoordinateLogger"><code>Molly.CoordinateLogger</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">CoordinateLogger(n_steps; dims=3)</code></pre><p>Log the coordinates throughout a simulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/loggers.jl#L43-L47">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.Coulomb" href="#Molly.Coulomb"><code>Molly.Coulomb</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Coulomb(nl_only)</code></pre><p>The Coulomb electrostatic interaction.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/interactions/coulomb.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.DistanceNeighbourFinder" href="#Molly.DistanceNeighbourFinder"><code>Molly.DistanceNeighbourFinder</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">DistanceNeighbourFinder(nb_matrix, n_steps, dist_cutoff)
DistanceNeighbourFinder(nb_matrix, n_steps)</code></pre><p>Find close atoms by distance.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/neighbours.jl#L30-L35">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.EnergyLogger" href="#Molly.EnergyLogger"><code>Molly.EnergyLogger</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">EnergyLogger(n_steps)</code></pre><p>Log the energy of the system throughout a simulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/loggers.jl#L74-L78">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.GeneralInteraction" href="#Molly.GeneralInteraction"><code>Molly.GeneralInteraction</code></a> — <span class="docstring-category">Type</span></header><section><div><p>A general interaction that will apply to all atom pairs. Custom general interactions should sub-type this type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/types.jl#L21-L24">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.Gravity" href="#Molly.Gravity"><code>Molly.Gravity</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Gravity(nl_only, G)</code></pre><p>The gravitational interaction.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/interactions/gravity.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.HarmonicAngle" href="#Molly.HarmonicAngle"><code>Molly.HarmonicAngle</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">HarmonicAngle(i, j, k, th0, cth)</code></pre><p>A bond angle between three atoms.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/interactions/harmonic_angle.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.HarmonicBond" href="#Molly.HarmonicBond"><code>Molly.HarmonicBond</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">HarmonicBond(i, j, b0, kb)</code></pre><p>A harmonic bond between two atoms.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/interactions/harmonic_bond.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.Interaction" href="#Molly.Interaction"><code>Molly.Interaction</code></a> — <span class="docstring-category">Type</span></header><section><div><p>An interaction between atoms that contributes to forces on the atoms.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/types.jl#L18">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.LennardJones" href="#Molly.LennardJones"><code>Molly.LennardJones</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">LennardJones(nl_only)</code></pre><p>The Lennard-Jones 6-12 interaction. The potential is given by</p><div>\[V_{ij}(r_{ij}) = 4\varepsilon_{ij} \left[\left(\frac{\sigma_{ij}}{r_{ij}}\right)^{12} - \left(\frac{\sigma_{ij}}{r_{ij}}\right)^{6}\right]\]</div><p>and the force on each atom by</p><div>\[\begin{aligned}
\vec{F}_i &amp;= 24\varepsilon_{ij} \left(2\frac{\sigma_{ij}^{12}}{r_{ij}^{13}} - \frac{\sigma_{ij}^6}{r_{ij}^{7}}\right) \frac{\vec{r}_{ij}}{r_{ij}} \\
&amp;= \frac{24\varepsilon_{ij}}{r_{ij}^2} \left[2\left(\frac{\sigma_{ij}^{6}}{r_{ij}^{6}}\right)^2 -\left(\frac{\sigma_{ij}}{r_{ij}}\right)^{6}\right] \vec{r}_{ij}
\end{aligned}\]</div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/interactions/lennard_jones.jl#L1-L15">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.Logger" href="#Molly.Logger"><code>Molly.Logger</code></a> — <span class="docstring-category">Type</span></header><section><div><p>A way to record a property, e.g. the temperature, throughout a simulation. Custom loggers should sub-type this type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/types.jl#L57-L60">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.Mie" href="#Molly.Mie"><code>Molly.Mie</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Mie(m, n, nl_only)</code></pre><p>The Mie generalized interaction. When <code>m</code> equals 6 and <code>n</code> equals 12 this is equivalent to the Lennard Jones interaction.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/interactions/mie.jl#L1-L6">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.NeighbourFinder" href="#Molly.NeighbourFinder"><code>Molly.NeighbourFinder</code></a> — <span class="docstring-category">Type</span></header><section><div><p>A way to find near atoms to save on simulation time. Custom neighbour finders should sub-type this type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/types.jl#L51-L54">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.NoNeighbourFinder" href="#Molly.NoNeighbourFinder"><code>Molly.NoNeighbourFinder</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">NoNeighbourFinder()</code></pre><p>Placeholder neighbour finder that returns no neighbours. When using this neighbour finder, ensure that <code>nl_only</code> for the interactions is set to <code>false</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/neighbours.jl#L8-L14">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.NoThermostat" href="#Molly.NoThermostat"><code>Molly.NoThermostat</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">NoThermostat()</code></pre><p>Placeholder thermostat that does nothing.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/thermostats.jl#L11-L15">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.Simulation" href="#Molly.Simulation"><code>Molly.Simulation</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Simulation(; &lt;keyword arguments&gt;)</code></pre><p>The data needed to define and run a molecular simulation. Properties unused in the simulation or in analysis can be left with their default values.</p><p><strong>Arguments</strong></p><ul><li><code>simulator::Simulator</code>: the type of simulation to run.</li><li><code>atoms::Vector{A}</code>: the atoms, or atom equivalents, in the simulation. Can be   of any type.</li><li><code>specific_inter_lists::SI=()</code>: the specific interactions in the simulation,   i.e. interactions between specific atoms such as bonds or angles. Typically   a <code>Tuple</code>.</li><li><code>general_inters::GI=()</code>: the general interactions in the simulation, i.e.   interactions between all or most atoms such as electrostatics. Typically a   <code>Tuple</code>.</li><li><code>coords::C</code>: the coordinates of the atoms in the simulation. Typically a   <code>Vector</code> of <code>SVector</code>s of any dimension and type <code>T</code>, where <code>T</code> is an   <code>AbstractFloat</code> type.</li><li><code>velocities::C=zero(coords)</code>: the velocities of the atoms in the simulation,   which should be the same type as the coordinates. The meaning of the   velocities depends on the simulator used, e.g. for the <code>VelocityFreeVerlet</code>   simulator they represent the previous step coordinates for the first step.</li><li><code>temperature::T=0.0</code>: the temperature of the simulation.</li><li><code>box_size::T</code>: the size of the cube in which the simulation takes place.</li><li><code>neighbour_finder::NeighbourFinder=NoNeighbourFinder()</code>: the neighbour finder   used to find close atoms and save on computation.</li><li><code>thermostat::Thermostat=NoThermostat()</code>: the thermostat which applies during   the simulation.</li><li><code>loggers::Dict{String, &lt;:Logger}=Dict()</code>: the loggers that record properties   of interest during the simulation.</li><li><code>timestep::T=0.0</code>: the timestep of the simulation.</li><li><code>n_steps::Integer=0</code>: the number of steps in the simulation.</li><li><code>n_steps_made::Vector{Int}=[]</code>: the number of steps already made during the   simulation. This is a <code>Vector</code> to allow the <code>struct</code> to be immutable.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/types.jl#L150-L186">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.Simulator" href="#Molly.Simulator"><code>Molly.Simulator</code></a> — <span class="docstring-category">Type</span></header><section><div><p>A type of simulation to run, e.g. leap-frog integration or energy minimisation. Custom simulators should sub-type this type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/types.jl#L39-L42">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.SoftSphere" href="#Molly.SoftSphere"><code>Molly.SoftSphere</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">SoftSphere(nl_only)</code></pre><p>The soft-sphere potential.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/interactions/soft_sphere.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.SpecificInteraction" href="#Molly.SpecificInteraction"><code>Molly.SpecificInteraction</code></a> — <span class="docstring-category">Type</span></header><section><div><p>A specific interaction between sets of specific atoms, e.g. a bond angle. Custom specific interactions should sub-type this type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/types.jl#L27-L30">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.StructureWriter" href="#Molly.StructureWriter"><code>Molly.StructureWriter</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">StructureWriter(n_steps, filepath)</code></pre><p>Write 3D output structures to the PDB file format throughout a simulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/loggers.jl#L101-L105">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.TemperatureLogger" href="#Molly.TemperatureLogger"><code>Molly.TemperatureLogger</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">TemperatureLogger(n_steps)
TemperatureLogger(T, n_steps)</code></pre><p>Log the temperature throughout a simulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/loggers.jl#L10-L15">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.Thermostat" href="#Molly.Thermostat"><code>Molly.Thermostat</code></a> — <span class="docstring-category">Type</span></header><section><div><p>A way to keep the temperature of a simulation constant. Custom thermostats should sub-type this type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/types.jl#L45-L48">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.Torsion" href="#Molly.Torsion"><code>Molly.Torsion</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Torsion(i, j, k, l, f1, f2, f3, f4)</code></pre><p>A dihedral torsion angle between four atoms.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/interactions/torsion.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.Torsiontype" href="#Molly.Torsiontype"><code>Molly.Torsiontype</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Torsiontype(f1, f2, f3, f4)</code></pre><p>Gromacs torsion type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/setup.jl#L44-L48">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.VelocityFreeVerlet" href="#Molly.VelocityFreeVerlet"><code>Molly.VelocityFreeVerlet</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">VelocityFreeVerlet()</code></pre><p>The velocity-free Verlet integrator, also known as the Störmer method. In this case the <code>velocities</code> given to the <code>Simulator</code> act as the previous step coordinates for the first step.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/simulators.jl#L101-L107">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.VelocityVerlet" href="#Molly.VelocityVerlet"><code>Molly.VelocityVerlet</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">VelocityVerlet()</code></pre><p>The velocity Verlet integrator.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/simulators.jl#L8-L12">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.accelerations-Tuple{Simulation}" href="#Molly.accelerations-Tuple{Simulation}"><code>Molly.accelerations</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">accelerations(simulation; parallel=true)</code></pre><p>Calculate the accelerations of all atoms using the general and specific interactions and Newton&#39;s second law.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/forces.jl#L41-L46">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.adjust_bounds-Tuple{Real,Real}" href="#Molly.adjust_bounds-Tuple{Real,Real}"><code>Molly.adjust_bounds</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">adjust_bounds(c, box_size)</code></pre><p>Ensure a coordinate is within the simulation box and return the coordinate.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/spatial.jl#L37-L41">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.apply_thermostat!-Tuple{Any,Simulation,NoThermostat}" href="#Molly.apply_thermostat!-Tuple{Any,Simulation,NoThermostat}"><code>Molly.apply_thermostat!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">apply_thermostat!(simulation, thermostat)</code></pre><p>Apply a thermostat to modify a simulation. Custom thermostats should implement this function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/thermostats.jl#L18-L23">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.displacements-Tuple{Any,Real}" href="#Molly.displacements-Tuple{Any,Real}"><code>Molly.displacements</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">displacements(coords, box_size)</code></pre><p>Get the pairwise vector displacements of a set of coordinates, accounting for the periodic boundary conditions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/analysis.jl#L36-L41">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.distances-Tuple{Any,Real}" href="#Molly.distances-Tuple{Any,Real}"><code>Molly.distances</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">distances(coords, box_size)</code></pre><p>Get the pairwise distances of a set of coordinates, accounting for the periodic boundary conditions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/analysis.jl#L49-L54">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.energy-Tuple{Any}" href="#Molly.energy-Tuple{Any}"><code>Molly.energy</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">energy(s)</code></pre><p>Compute the total energy of the system.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/analysis.jl#L74-L78">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.find_neighbours!-Tuple{Simulation,NoNeighbourFinder,Integer}" href="#Molly.find_neighbours!-Tuple{Simulation,NoNeighbourFinder,Integer}"><code>Molly.find_neighbours!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">find_neighbours!(simulation, neighbour_finder, step_n; parallel=true)</code></pre><p>Obtain a list of close atoms in a system. Custom neighbour finders should implement this function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/neighbours.jl#L17-L22">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.force" href="#Molly.force"><code>Molly.force</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">force(inter, coord_i, coord_j, atom_i, atom_j, box_size)</code></pre><p>Calculate the force between a pair of atoms due to a given interation type. Custom interaction types should implement this function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/forces.jl#L17-L22">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.log_property!-Tuple{TemperatureLogger,Simulation,Integer}" href="#Molly.log_property!-Tuple{TemperatureLogger,Simulation,Integer}"><code>Molly.log_property!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">log_property!(logger, simulation, step_n)</code></pre><p>Log a property thoughout a simulation. Custom loggers should implement this function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/loggers.jl#L31-L36">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.maxwellboltzmann-Tuple{Type,Real,Real}" href="#Molly.maxwellboltzmann-Tuple{Type,Real,Real}"><code>Molly.maxwellboltzmann</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">maxwellboltzmann(mass, temperature)
maxwellboltzmann(T, mass, temperature)</code></pre><p>Draw from the Maxwell-Boltzmann distribution.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/thermostats.jl#L62-L67">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.placeatoms-Tuple{Type,Integer,Real,Real}" href="#Molly.placeatoms-Tuple{Type,Integer,Real,Real}"><code>Molly.placeatoms</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">placeatoms(n_atoms, box_size, min_dist)
placeatoms(T, n_atoms, box_size, min_dist)</code></pre><p>Obtain <code>n_atoms</code> 3D coordinates in a cube of length <code>box_size</code> where no two points are closer than <code>min_dist</code>, accounting for periodic boundary conditions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/setup.jl#L56-L62">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.rdf-Tuple{Any,Real}" href="#Molly.rdf-Tuple{Any,Real}"><code>Molly.rdf</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">rdf(coords, box_size; npoints=200)</code></pre><p>Get the radial distribution function of a set of coordinates. This describes how density varies as a function of distance from each atom. Returns a list of distance bin centres and a list of the corresponding densities.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/analysis.jl#L57-L64">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.readinputs-Tuple{Type,AbstractString,AbstractString}" href="#Molly.readinputs-Tuple{Type,AbstractString,AbstractString}"><code>Molly.readinputs</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">readinputs(topology_file, coordinate_file; atom_min=false)
readinputs(T, topology_file, coordinate_file; atom_min=false)</code></pre><p>Read a Gromacs topology flat file, i.e. all includes collapsed into one file, and a Gromacs coordinate file. Returns the atoms, specific interaction lists, general interaction lists, non-bonded matrix, coordinates and box size. <code>atom_min</code> determines whether the returned atoms consist of the GPU-compatible <code>AtomMin</code> or the more verbose but GPU-incompatible <code>Atom</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/setup.jl#L86-L96">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.simulate!-Tuple{Simulation{false,T,A,C,GI,SI} where SI where GI where C where A where T,VelocityVerlet,Integer}" href="#Molly.simulate!-Tuple{Simulation{false,T,A,C,GI,SI} where SI where GI where C where A where T,VelocityVerlet,Integer}"><code>Molly.simulate!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">simulate!(simulation; parallel=true)
simulate!(simulation, n_steps; parallel=true)
simulate!(simulation, simulator, n_steps; parallel=true)</code></pre><p>Run a simulation according to the rules of the given simulator. Custom simulators should implement this function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/simulators.jl#L15-L22">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.temperature-Tuple{Simulation{false,T,A,C,GI,SI} where SI where GI where C where A where T}" href="#Molly.temperature-Tuple{Simulation{false,T,A,C,GI,SI} where SI where GI where C where A where T}"><code>Molly.temperature</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">temperature(simulation)</code></pre><p>Calculate the temperature of a system from the kinetic energy of the atoms.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/thermostats.jl#L76-L80">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.vector-Tuple{Any,Any,Real}" href="#Molly.vector-Tuple{Any,Any,Real}"><code>Molly.vector</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">vector(c1, c2, box_size)</code></pre><p>Displacement between two coordinate values, accounting for the bounding box. The minimum image convention is used, so the displacement is to the closest version of the coordinates accounting for the periodic boundaries.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/spatial.jl#L23-L29">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.vector1D-Tuple{Real,Real,Real}" href="#Molly.vector1D-Tuple{Real,Real,Real}"><code>Molly.vector1D</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">vector1D(c1, c2, box_size)</code></pre><p>Displacement between two 1D coordinate values, accounting for the bounding box. The minimum image convention is used, so the displacement is to the closest version of the coordinate accounting for the periodic boundaries.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/spatial.jl#L8-L14">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.velocity-Tuple{Type,Real,Real}" href="#Molly.velocity-Tuple{Type,Real,Real}"><code>Molly.velocity</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">velocity(mass, temperature; dims=3)
velocity(T, mass, temperature; dims=3)</code></pre><p>Generate a random velocity from the Maxwell-Boltzmann distribution.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/thermostats.jl#L48-L53">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Molly.visualize" href="#Molly.visualize"><code>Molly.visualize</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">visualize(coord_logger, box_size, out_filepath; &lt;keyword arguments&gt;)</code></pre><p>Visualize a simulation as an animation. This function is only available when Makie is imported. It can take a while to run, depending on the length and size of the simulation.</p><p><strong>Arguments</strong></p><ul><li><code>connections=Tuple{Int, Int}[]</code>: pairs of atoms indices to link with bonds.</li><li><code>connection_frames</code>: the frames in which bonds are shown. Is a list of the   same length as the number of frames, where each item is a list of <code>Bool</code>s of   the same length as <code>connections</code>. Defaults to always <code>true</code>.</li><li><code>trails::Integer=0</code>: the number of preceding frames to show as transparent   trails.</li><li><code>framerate::Integer=30</code>: the frame rate of the animation.</li><li><code>color=:purple</code>: the color of the atoms. Can be a single color or a list of   colors of the same length as the number of atoms.</li><li><code>connection_color=:orange</code>: the color of the bonds. Can be a single color or a   list of colors of the same length as <code>connections</code>.</li><li><code>markersize=0.1</code>: the size of the atom markers.</li><li><code>linewidth=2.0</code>: the width of the bond lines.</li><li><code>transparency=true</code>: whether transparency is active on the plot.</li><li><code>kwargs...</code>: other keyword arguments are passed to the plotting function.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMolSim/Molly.jl/blob/52cb3fea21c791e19d4aa564650e98f1fb56548d/src/analysis.jl#L10-L33">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../examples/">« Examples</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Thursday 8 October 2020 01:31">Thursday 8 October 2020</span>. Using Julia version 1.5.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
